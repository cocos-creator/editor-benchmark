<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title> Hidden classes </title>
    <link rel="stylesheet" href="node_modules/astrobench/src/style.css">
</head>
<body>
    <!-- Wrapper for tests -->
    <div id="astrobench"></div>
    <script src="node_modules/astrobench/dist/astrobench.js"></script>

    <script>
        // A test suite begins with a call to the global function `suite` with two parameters:
        // a string and a function.
        // The string is a name or title for a spec suite â€“ usually what is being tested.
        // The function is a block of code that implements the suite.
        suite('Hidden classes', function(suite) {
            var count = 10000;
            var baseLine = new Array(count);
            var pointInstances = new Array(count);
            var pointLiterals = new Array(count);

            // To help a test suite DRY up any duplicated setup code, provides
            // the global `setup` functions.
            // As the name implies the `setup` function is called once.
            // You can store data in `suite` Object, or define necessary variables.
            // Code from body of the function will be presented in UI.
            setup(function() {
                function Point (x, y, z) {
                    this.x = x;
                    this.y = y;
                    this.z = z;
                }
                for (var i = 0; i < count; i++) {
                    baseLine[i] = 1;
                    pointInstances[i] = new Point(1, 2, 3);
                    pointLiterals[i] = { x: 1, y: 2, z: 3 };
                }
            });

            // Benchmark are defined by calling the global function `bench`,
            // which, like `suite` takes a string and a function.
            // The string is the title of the test and the function is the test
            bench('baseline', function() {
                var xSum = 0, ySum = 0, zSum = 0;
                var array = baseLine;
                for (var i = 0; i < count; i++) {
                    var one = array[i];
                    xSum += one;
                    ySum += 2;
                    zSum += 3;
                }
            });

            bench('get property from typed instance', function() {
                var xSum = 0, ySum = 0, zSum = 0;
                var array = pointInstances;
                for (var i = 0; i < count; i++) {
                    var item = array[i];
                    xSum += item.x;
                    ySum += item.y;
                    zSum += item.z;
                }
            });

            bench('get property from literal object', function() {
                var xSum = 0, ySum = 0, zSum = 0;
                var array = pointLiterals;
                for (var i = 0; i < count; i++) {
                    var item = array[i];
                    xSum += item.x;
                    ySum += item.y;
                    zSum += item.z;
                }
            });
        });
    </script>
</body>
</html>